<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert Image To Grayscale</title>
    <script src="http://www.dukelearntoprogram.com/course1/common/js/image/SimpleImage.js"></script>
    <style>
        h1 {
          font-family: arial;
          color: dimgray;
        }
        body {
          font-family: arial;
          margin: 30px;
        }
        canvas {
          height: 200px;
          border: 1px solid lightgray;
        }
        input {
          font-size: 14pt;
        }
    </style>
    <script>
        var image = null;
        function upload(){
            var fileinput = document.getElementById("finput");
            image = new SimpleImage(fileinput);
            var canvas  = document.getElementById("can");
            image.drawTo(canvas);
        }
        function makeGray() {
            for (var pixel of image.values()) {
                var avg = (pixel.getRed()+pixel.getGreen()+pixel.getBlue())/3;
                pixel.setRed(avg);
                pixel.setGreen(avg);
                pixel.setBlue(avg);
            }
            //display new image
            var canvas = document.getElementById("can");
            image.drawTo(canvas);
        }
    </script>
</head>
<body>
    <h1>Convert Image to Grayscale</h1>

    <canvas id="can">
    </canvas>

    <p>
        <input type="file" multiple="false" accept="image/*" id="finput" onchange="upload()" >
    </p>
    <p>
        <input type="button" value="Make Grayscale" onclick="makeGray()" >
    </p>
</body>
</html>